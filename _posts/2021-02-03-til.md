---
layout: post
tags: [all, os]
title: "💡 struct OS PintOS;"
date: 2021-02-03 00:00:00 -0400
categories: TIL
background: '/img/bg-post.jpg'
comments: true
---
> 운영체제를 직접 구현하다. 03.02.화 (수정). 

## Tools  

- `C`, `AWS Linux`, 뭐 기타 등등 ...

## 감상 회고  

🎰\[3주차\]  
자존감이 바닥을 치는 경험을 하고싶으면 바로 핀토스 개발을 하라고 권하고 싶다.  
CS를 배우는 과정이 내 나름 적성에 맞는다고 생각했는데, 극심한 우울감과 함께 진로에 대해 심각하게 고민할 수 있는 시간을 가졌다.  
gdb를 좀 더 깊게 이해했으면 디버깅이 더 쉬었을까 싶지만, 나의 빈틈없는(진짜 없었다.) printf 앞에서 무너져 내려가는 fail 수에 만족하고 그냥 진행했다.  
이번 주차의 핀토스 빡침 포인트는 이해를 조금 했다싶으면, 모자란 지식의 깊이를 인정하고 책과 [gitbook](!https://casys-kaist.github.io/pintos-kaist/)을 펴보게 되는 부끄러운 내 자신을 보는 것과 코드를 작성 하고 난 뒤에 `make check` 하여 분명히 pass가 뜬 tc에서 무언가 참신한 ~~새끼~~ 가 나와서 나를 괴롭히는 것을 지켜보는 일인데, 두더지 게임 마냥 항상 다른 타이밍에 다른 공간에서 가끔씩 얼굴을 내민다.  
누가 이기나 보자는 식으로 두드리는 수십번의 `make check`에서 pass가 뜨길 기다리고 있자면 파칭코 장에 온 기분을 느낄 수 있게 해준다. 찍히는 addr도 0x18인데 욕만 늘고 미칠 것 같다. 주변의 많은 도움으로 높은 확률로 tc를 통과하고 있지만 coccurrency를 완전히 정복하지 못하면 계속 이 지경일 건데 deadline이 지난 이 시점에 패배감이 밀려온다. 패퇴했다.    
PROJECT3는 VIRTUAL MEMORY를 주제로 프로젝트를 진행하게 된다. 말 그대로 우리는 프로그램 상에서 가상의 주소를 가지는 메모리를 할당 받아 물리적인 한계를 뛰어넘을 수 있도록 하는 트릭을 생성해 OS, `Kernel`이 하게 해준다.  
이전 주차까지의 핀토스가 Kernel space의 메모리를 이용하여 모든 일을 수행하던 것을 Virtual Memory의 개념으로서의 본연의 목적을 가지도록 관리할 수 있게되었다. 익명 페이지와 파일 페이지 등으로 메모리를 특징과 일정 크기로 분리하여 관리할 수 있게 되었고, 필요에 따라 가상메모리를 좀 더 확장하여 
많은 정보를 미리 가지고 활용할 수 있다. 이것이 필요한 것은 역시나 `시간`이라는 것(물리 메모리의 한계를 극복하는건 기본이고)을 단축하기 위함인데 간단하게 말하자면, 물리적인 연결을 최대한 지양하려고 하는 노력의 일환이라고 해석하고 있다. 필요에 따라 물리 메모리에 가상 메모리의 정보를 적재함(`Swap In/Swap Out`)으로서 이를 해결한다.  
아직도 디버깅을 하고 있지만 다음 주차까지 팀원들과 억지 파이팅을 해보려고 한다.  

📗\[2주차\]  
USER PROGRAMMING을 개발하는 2주차를 마쳤다. /USERPROG/ 안의 테스트 케이스가 92개가 있는데 특정 케이스를 위해 수정하는 과정을 겪으면, 맞았던게 틀리고, 3개의 fail이 뜨던 중 수정을 하니 23개가 틀리는 기이 현상을 자주 경험했다. 얼마나 코드가 유기적으로 돌아가는지 직접 느낄 수 있어서 신기하면서도 굉장한 스트레스를 받게 되었다.  
사실, 돌이켜보니 부분적인 문제 해결에 힘쓰느라 전체적인 흐름과 구조에 대해서 상세하게 기술할 정도로 익숙하지는 못하다. 당연하겠지만, 추가적으로 이에 대해 더 개인적으로 공부하거나, 이 후 프로젝트를 진행하며 지식을 꾸준히 학습하는 것이 어쩌면 당연해 보인다.  
어셈블리어와 C언어에 대한 이해가 깊어질 수 있었던 한 주였다. ISA에 모든 정보?는 데이터 타입 혹은 주소 타입으로 저장되고 있다는 사실은 아직까지도 굉장히 충격적으로 다가온다.  
왜 그들이 C언어를 이해하면 좋은지에 대해 설파하는지 조금 깨닫게 되었다. 요는 이것이다. 어셈블리와 C언어는 모든 정보?는 데이터 타입 혹은 주소 타입으로'만' 저장되고 있다는 사실 (ISA에 대한 추가적인 학습이 필요할 것 같다.), 그렇기 때문에 특정 어셈블리에 맵핑되는 언어로서(기계에 근접한 언어로서)의 위상을 가지고 있는 것이다.  
모든 행위를 메모리에 저장된 주소 타입과 값 타입으로 해결할 수 있다는 사실에 경외감을 느낀다.  

📕\[1주차\]  
다행히도 1주 차는 좋은 가이드라인이 있어 시간 안에 문제를 잘 해결 한 것 같다.  
인터럽트 문제가 발생할 때는, 포인터들의 주소 값이 NULL이 아닌지 체크를 꼭 하자.  
네트워크 스터디, 알고리즘 스터디를 병행하고 있어 시간 조율하는 과정에서 많은 정신적, 체력적 소모가 있었다. 1주차에서 이런 감정을 느껴 조금 불안하다고 생각하는 중이다.  
프론트엔드 스터디도 시작해야하는데 스터디를 조금 줄여야 하는가 생각을 하게 된다.  

## 행군 시작

군대에서 행군하던 때가 생각난다. 깜깜한 도로를 정처없이 걷다가보면 결국 도착지에 도달할 것만 같다. 
지금 내 모습이다 새벽 3시... 배고프고 졸리다.  

> 2달 뒤에 나도 직접 쳐보리라.... _ssxbxl done_  

이 포스트는 PintOS를 개발하며 배운 내용을 정리하는 공간이 될 것 같다.  
정글에서의 활동 2달여 간의 시간 동안 자료구조, 알고리즘, Malloc Lab , Tiny Web Server 프로젝트를 마쳤다. 이어서 우리는 2달여 간 Kaist의 실제 학부 과정에 있는 PintOS 개발에 돌입했다. 🎯  
시간이나 챕터 단위로 진행하고 그 때마다 포스팅을 하게 될 것같구, 내용이 모든 것을 포함한다고 보장하지는 못할 것 같다..  

우리는 3명이 한 조가 되어 프로젝트를 진행하게 되는데 일반적으로,  
매 주 하나의 PROJECT를 진행하게 되며, 이에 관련된 내용을 포스팅할 것이다. 내가 완전히 이해하고 꼭 짚고 넘어가고 싶은 포인트만 적어보련다.  

📌 PROJECT1 : THREADS  
1. Alarm Clock
2. Priority Scheduling
3. Advanced Schedular  

📌 PROJECT2 : USER PROGRAMMING  
1. Argument Passing
2. User Memory
3. System Calls
4. Process Termination Messages
5. Denying Writes to Executables
6. Extend File Description  

📌 PROJECT3 : VIRTUAL MEMORY  
1. Memory Management
2. Anonymouse Page
3. Stack Growth  
4. Memory Mapped Files  
5. Swap In/Out  
6. Copy-On-Write  

📌 PROJECT4 : FILE SYSTEM  
1. Indexed and Extensible Files
2. Subdirectories and Soft Links
3. Buffer Cache
4. Synchronization
5. Mount
6. FileSystem Journaling  



## Reference
---
[KAIST PintOS Intro](!https://casys-kaist.github.io/pintos-kaist/)